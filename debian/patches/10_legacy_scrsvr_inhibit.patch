Description: Reintroduce legacy API for inhibiting the screensaver
Author: Chris Coulson <chrisccoulson@ubuntu.com>
Bug-Ubuntu: https://bugs.launchpad.net/bugs/428884
Bug: https://bugzilla.gnome.org/show_bug.cgi?id=579430
Forwarded: https://bugzilla.gnome.org/show_bug.cgi?id=579430

diff -Nur -x '*.orig' -x '*~' gnome-screensaver-2.28.0/src/gs-monitor.c gnome-screensaver-2.28.0.new/src/gs-monitor.c
--- gnome-screensaver-2.28.0/src/gs-monitor.c	2009-08-20 00:19:14.000000000 +0100
+++ gnome-screensaver-2.28.0.new/src/gs-monitor.c	2010-01-11 22:18:42.545853779 +0000
@@ -28,6 +28,8 @@
 
 #include <glib.h>
 #include <glib-object.h>
+#include <X11/Xlib.h>
+#include <gdk/gdkx.h>
 
 #include "gnome-screensaver.h"
 
@@ -186,7 +188,7 @@
 static void
 gs_monitor_simulate_user_activity (GSMonitor *monitor)
 {
-        /* FIXME: reset the xsync timer? */
+        XResetScreenSaver (GDK_DISPLAY_XDISPLAY (gdk_display_get_default ()));
 
         /* request that the manager unlock -
            will pop up a dialog if necessary */
